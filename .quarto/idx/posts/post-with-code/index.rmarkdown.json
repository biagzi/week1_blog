{"title":"Bayesian regression","markdown":{"yaml":{"title":"Bayesian regression","author":"Renata B. Biazzi","date":"2024-01-31","categories":["news","code","analysis"],"image":"Petal-sepal.jpg"},"headingText":"Specifying our prior distribution","containsRefs":false,"markdown":"\n\n\nIn this tutorial, I will show how to do a **Bayesian regression** in [brms](https://cran.r-project.org/web/packages/brms/index.html)!\n\nThe first part is loading the necessary packages:\n\n\n```{r}\nlibrary(datasets) #to open the dataset\nlibrary(rstan) \nlibrary(brms)\nlibrary(psych) #to summary statistics\nlibrary(tidyverse) # for data manipulation and plotting\n```\n\n\nIn this tutorial, we will use data from the Iris data set - maybe one of the most famous data sets ever. It was used by the British statistician and biologist Ronald Fisher to show how to distinguish three different, but related, species of Iris flowers using their morphological features. Edgar Anderson collected the data when he was trying to quantify the morphological variation of them.\n\nData description:\n\n50 samples from each of the three species ([*Iris setosa*](https://en.wikipedia.org/wiki/Iris_setosa \"Iris setosa\"), [*Iris virginica*](https://en.wikipedia.org/wiki/Iris_virginica \"Iris virginica\") and [*Iris versicolor*](https://en.wikipedia.org/wiki/Iris_versicolor \"Iris versicolor\"));\n\nFeatures:\n\n-   length of the sepals\n\n-   length of the petals\n\n-   width of the sepals\n\n-   width of the petals.\n\nOpening and inspecting the data:\n\n\n```{r}\ndata(iris)\nsummary(iris)\n```\n\n\nExploring the data:\n\n\n```{r}\nggplot(iris, aes(x = Sepal.Length)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Sepal.Length Distribution\", x = \"Sepal.Length\", y = \"Frequency\")\n\nggplot(iris, aes(x = Sepal.Width)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Sepal.Width Distribution\", x = \"Sepal.Width\", y = \"Frequency\")\n\nggplot(iris, aes(x = Petal.Length)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Petal.Length Distribution\", x = \"Petal.Length\", y = \"Frequency\")\n\nggplot(iris, aes(x = Petal.Width)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Petal.Width Distribution\", x = \"Petal.Width\", y = \"Frequency\")\n\n```\n\n\nIn this tutorial we will investigate the impact of sepal and petals length on the sepal width (our outcome variable) independent of the species. In the future, you can try to do other interesting analysis, as assessing how much this features predict the length of the petals for each one of the species.\n\nIn a Bayesian approach, we use a first belief of how likely is some hypothesis (prior) to be able to derive the probability of this hypothesis (posterior) after using the prior with the data we have.\n\nThe specification of the prior distribution is a crucial point. In our case, we will use a normal distribution.\n\n\n```{r}\nprior <- brms::prior(normal(0, 10), class=b) #set normal prior on regression coefficients (mean of 0, location of 3)\n```\n\n\nSo, now we run or Bayesian regression by specifying our model:\n\n\n```{r}\nmodel <- brm(formula = Sepal.Width ~ Sepal.Length + Petal.Length, \n             data    = iris,\n             seed    = 123,\n             prior = prior,\n             chains=4, # how many chains are run\n            iter = 500) # number of MCMC samples\n```\n\n\nVisualize the distribution of values for each parameters and the chains convergence.\n\n\n```{r}\nplot(model)\n```\n\n\nNow we will analyze and interpret the coefficients:\n\n\n```{r}\nsummary(model)\n```\n\n\nWe can see from the summary that our chains have converged sufficiently (rhat close to 1).\n\nThe length of the sepals seems to be a relevant predictor of the length of the petals for iris flowers, with a posterior mean regression coefficient of 1.78, 95% Credibility Interval \\[1.65, 1.90\\]. The length of the petals are also relevant predictors, with a posterior mean of -0.33, and a 95% credibility Interval of \\[-1.40, -0.28\\]. Since the intervals do not include zero, we can be fairly sure there is an effect.\n\nNow, we will analyze the posterior distribution:\n\n\n```{r}\npp_check(model, ndraws=100)\n\n```\n\n\nAnalyzing the posterior, we see that the samples from the posterior predictive distribution (y_rep) seems to capture really well the observed data (y).\n\nNext week we will see how to make our model better!\n\nWe can try other priors and then compare different models. We can also test interaction terms between the predictors, and check if all the predictor variables are really necessary.\n\n","srcMarkdownNoYaml":"\n\n\nIn this tutorial, I will show how to do a **Bayesian regression** in [brms](https://cran.r-project.org/web/packages/brms/index.html)!\n\nThe first part is loading the necessary packages:\n\n\n```{r}\nlibrary(datasets) #to open the dataset\nlibrary(rstan) \nlibrary(brms)\nlibrary(psych) #to summary statistics\nlibrary(tidyverse) # for data manipulation and plotting\n```\n\n\nIn this tutorial, we will use data from the Iris data set - maybe one of the most famous data sets ever. It was used by the British statistician and biologist Ronald Fisher to show how to distinguish three different, but related, species of Iris flowers using their morphological features. Edgar Anderson collected the data when he was trying to quantify the morphological variation of them.\n\nData description:\n\n50 samples from each of the three species ([*Iris setosa*](https://en.wikipedia.org/wiki/Iris_setosa \"Iris setosa\"), [*Iris virginica*](https://en.wikipedia.org/wiki/Iris_virginica \"Iris virginica\") and [*Iris versicolor*](https://en.wikipedia.org/wiki/Iris_versicolor \"Iris versicolor\"));\n\nFeatures:\n\n-   length of the sepals\n\n-   length of the petals\n\n-   width of the sepals\n\n-   width of the petals.\n\nOpening and inspecting the data:\n\n\n```{r}\ndata(iris)\nsummary(iris)\n```\n\n\nExploring the data:\n\n\n```{r}\nggplot(iris, aes(x = Sepal.Length)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Sepal.Length Distribution\", x = \"Sepal.Length\", y = \"Frequency\")\n\nggplot(iris, aes(x = Sepal.Width)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Sepal.Width Distribution\", x = \"Sepal.Width\", y = \"Frequency\")\n\nggplot(iris, aes(x = Petal.Length)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Petal.Length Distribution\", x = \"Petal.Length\", y = \"Frequency\")\n\nggplot(iris, aes(x = Petal.Width)) +\n  geom_histogram(binwidth = 0.1, fill = \"pink\", color = \"black\") +\n  labs(title = \"Petal.Width Distribution\", x = \"Petal.Width\", y = \"Frequency\")\n\n```\n\n\nIn this tutorial we will investigate the impact of sepal and petals length on the sepal width (our outcome variable) independent of the species. In the future, you can try to do other interesting analysis, as assessing how much this features predict the length of the petals for each one of the species.\n\nIn a Bayesian approach, we use a first belief of how likely is some hypothesis (prior) to be able to derive the probability of this hypothesis (posterior) after using the prior with the data we have.\n\nThe specification of the prior distribution is a crucial point. In our case, we will use a normal distribution.\n\n\n```{r}\n# Specifying our prior distribution\nprior <- brms::prior(normal(0, 10), class=b) #set normal prior on regression coefficients (mean of 0, location of 3)\n```\n\n\nSo, now we run or Bayesian regression by specifying our model:\n\n\n```{r}\nmodel <- brm(formula = Sepal.Width ~ Sepal.Length + Petal.Length, \n             data    = iris,\n             seed    = 123,\n             prior = prior,\n             chains=4, # how many chains are run\n            iter = 500) # number of MCMC samples\n```\n\n\nVisualize the distribution of values for each parameters and the chains convergence.\n\n\n```{r}\nplot(model)\n```\n\n\nNow we will analyze and interpret the coefficients:\n\n\n```{r}\nsummary(model)\n```\n\n\nWe can see from the summary that our chains have converged sufficiently (rhat close to 1).\n\nThe length of the sepals seems to be a relevant predictor of the length of the petals for iris flowers, with a posterior mean regression coefficient of 1.78, 95% Credibility Interval \\[1.65, 1.90\\]. The length of the petals are also relevant predictors, with a posterior mean of -0.33, and a 95% credibility Interval of \\[-1.40, -0.28\\]. Since the intervals do not include zero, we can be fairly sure there is an effect.\n\nNow, we will analyze the posterior distribution:\n\n\n```{r}\npp_check(model, ndraws=100)\n\n```\n\n\nAnalyzing the posterior, we see that the samples from the posterior predictive distribution (y_rep) seems to capture really well the observed data (y).\n\nNext week we will see how to make our model better!\n\nWe can try other priors and then compare different models. We can also test interaction terms between the predictors, and check if all the predictor variables are really necessary.\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"Bayesian regression","author":"Renata B. Biazzi","date":"2024-01-31","categories":["news","code","analysis"],"image":"Petal-sepal.jpg"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}