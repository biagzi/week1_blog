"0","#| echo: false"
"0","#| "
"0","# Manually calculate the logit values and tidy data for the plot"
"0",""
"0","bechdel=fivethirtyeight::bechdel"
"0",""
"0","bechdel <- bechdel  %>% "
"0","  mutate(pass = ifelse(binary == ""FAIL"", 0, 1)) "
"0",""
"0","bechdel_lin<- bechdel %>%"
"0","  dplyr::select(pass, budget_2013)"
"0",""
"0","fit <- glm("
"0","  data = bechdel,"
"0","  family = binomial,"
"0","  pass ~ 1 + budget_2013)"
"0",""
"0","bechdel_lin$prob <- fit$fitted.values"
"0",""
"0","df_model <- bechdel_lin %>%"
"0","  mutate(logit = log(prob/(1-prob)))"
"0","        "
"0","  ggplot(df_model, aes(y = logit, x = budget_2013))+"
"0","  geom_point(size = 0.5, alpha = 0.5) +"
"0","  geom_smooth(method = ""loess"") + "
"0","  theme_lucid(base_size=18)"
